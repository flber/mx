<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<title>Mineral Existence</title>
		<link rel="icon" href="favicon.ico?" type="image/x-icon">
		<link rel="stylesheet" href="https://use.typekit.net/tsn4urm.css">
		<link rel="stylesheet" href="style.css"/>
	</head>
	<body id="dark">
		<nav>
			<div style="display:flex; align-items: center;"> 
				<div class="right-border">
					<span class="dark"><h1><a href="index.html">Home</a></h1></span>
					<span class="light"><h1><a href="index.html#dark">Home</a></h1></span>
				</div>
				<div class="right-border">
					<span class="dark"><h1><a href="now.html">now</a></h1></span>
					<span class="light"><h1><a href="now.html#dark">now</a></h1></span>
				</div>
				<div class="right-border">
					<span class="dark"><h1><a href="wiki.html">wiki</a></h1></span>
					<span class="light"><h1><a href="wiki.html#dark">wiki</a></h1></span>
				</div>
				<div class="right-border">
					<span class="dark"><h1><a href="about.html">about</a></h1></span>
					<span class="light"><h1><a href="about.html#dark">about</a></h1></span>
				</div>
				<div style="margin-left: auto;">
					<span class="dark"><b><a href="#dark">{dark}</a></b></span>
					<span class="light"><b><a href="#">{light}</a></b></span>
				</div>
				<div style="clear: both;"></div>
			</div>
		</nav>
		<article class="inner">

<h2>An Introduction to the Wave Function Collapse Algorithm</h2>

<p>You may or may not already be familiar with the wave function collapse algorithm (wfc from now on), but if you're not, here's a brief overview.</p>

<p>First developed in October 2016 by <a href="https://twitter.com/ExUtumno/">Maxim Gumin</a>, the <a href="https://github.com/mxgmn/WaveFunctionCollapse">wfc algorithm</a> is a method of generating novel textures from a given input texture. The main reason this algorithm is interesting is that the output is locally similar to the input, as defined in the repository:</p>
<blockquote>
<p>Each NxN pattern of pixels in the output should occur at least once in the input. Distribution of NxN patterns in the input should be similar to the distribution of NxN patterns over a sufficiently large number of outputs. In other words, probability to meet a particular pattern in the output should be close to the density of such patterns in the input.</p>
</blockquote>

<p>That essentially just means that the output looks like the input, but because it's procedurally generated it can be arbitrarily large and even generated on the fly. Here's an example of it in action from Maxim's repository:</p>

<p><img src="images/wfc.gif" alt="wfc gif"/></p>

<p>Pretty cool, right?</p>

<h3>My Project</h3>

<p>If you're like me when you saw that gif, your first instinct would be to poke around and see if you could figure out how it works to make your own. In my experience however, while there are lots of great resources to learn generally how wfc works, there are far fewer in-depth analyses of the algorithm, its quirks, and the difficulties you might face trying to build your own version. The best resource, in my opinion, is <a href="https://twitter.com/isaackarth">Isaac Karth</a> and <a href="https://twitter.com/rndmcnlly">Adam M. Smith's</a> paper, <a href="https://adamsmith.as/papers/wfc_is_constraint_solving_in_the_wild.pdf">WaveFunctionCollapse is Constraint Solving in the Wild</a>, which provides a pretty detailed description of some of the main systems in the algorithm.</p>

<p>My goal (over an embarrassingly long span of time) has been to write my own implementation of the algorithm in the Lua language, with LOVE2D to make the graphics easier to handle. While I'm still not quite finished with the algorithm, in these posts I'll be explaining what I've done so far, the problems I've faced and the ways I solved them, and what I'm currently working on as I catch up to myself. All of that will include some actual code I've written (I apologize in advance for my atrocious formatting), and perhaps some diagrams and such depending on how artistic I'm feeling.</p>

<h3>Other Resources</h3>

<p>Here are some good videos, articles, and papers which I've used in my own research:</p>
<ul>
<li>The <a href="https://adamsmith.as/papers/wfc_is_constraint_solving_in_the_wild.pdf">aforementioned paper</a> by <a href="https://twitter.com/isaackarth">Isaac Karth</a> and <a href="https://twitter.com/rndmcnlly">Adam M. Smith</a></li>
<li><a href="https://twitter.com/ExUtumno/">Maxim Gumin's</a> <a href="https://github.com/mxgmn/WaveFunctionCollapse">repository</a></li>
<li><a href="https://twitter.com/OskSta">Oskar St√•lberg's</a> <a href="https://www.youtube.com/watch?v=0bcZb-SsnrA">talk</a> at EPC2018 on how wfc works</li>
<li><a href="https://twitter.com/unormal">Brian Bucklew's</a> <a href="https://www.youtube.com/watch?v=fnFj3dOKcIQ&t=1s">very interesting talk</a> on using wfc in dungeon generation in <a href="http://www.cavesofqud.com/">Caves of Qud</a> during the 2019 Roguelike Celebration, which I actually got to see in person!</li>
<li><a href="https://twitter.com/RobJHeaton">Robert Heaton's</a> great article called <a href="https://robertheaton.com/2018/12/17/wavefunction-collapse-algorithm/">"The Wavefunction Collapse Algorithm explained very clearly"</a></li>
</ul>


		</article>
		<footer>
			<nav aria-label="Contact links">
				<div style="float: left; margin-top: -3px;">
					<a href="mailto:benrhammond@gmail.com" aria-label="Email adress" title="Email adress"><svg version="1.0" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" viewBox="0 0 1280 1280"><path d="M614.5.6c-21.6 1.3-39.1 2.8-53 4.5-99.5 12.2-192.7 46.7-276 102.2-90.7 60.4-164.8 143.3-214.6 240.2-39.5 76.9-61.5 154.9-69 245-1.7 19.3-1.7 75.7 0 95 7.5 90.1 29.5 168.1 69 245 61 118.8 157.8 215.6 276.6 276.6 76.9 39.5 154.9 61.5 245 69 19.3 1.7 75.7 1.7 95 0 90.1-7.5 168.1-29.5 245-69 118.7-61 215.6-157.9 276.6-276.6 39.5-76.9 61.5-154.9 69-245 1.7-19.3 1.7-75.7 0-95-7.5-90.1-29.5-168.1-69-245-61-118.8-157.8-215.6-276.6-276.6-75.3-38.7-153.1-61-239-68.4-16.4-1.5-66.6-2.7-79-1.9zm73.9 77.9c109.8 9.4 212.1 49.9 300.1 118.8 40.1 31.4 80.4 73.8 110.6 116.2 59.8 84 94.4 179.3 103 284 1.6 19.3 1.6 65.7 0 85-11.4 138.5-69.3 262.8-167.2 359.1-96 94.2-217.2 149.4-352.4 160.5-19.3 1.6-65.7 1.6-85 0-135.2-11.1-256.1-66.1-352.3-160.5-97.9-96-156.1-221-167.3-359.1-1.5-19.3-1.5-65.7 0-85 11.2-138.4 69.3-262.9 167.8-359.6C332.9 152.3 444.2 97.6 564 81.6c41.6-5.5 83.2-6.6 124.4-3.1z"/><path d="M624.3 290c-59.9 3-109.9 15.3-159.3 39.1-70 33.8-120.1 84.5-157.4 159.4-24.3 48.9-38.3 99.9-42.7 155.9-2.4 30-.3 75.5 4.6 104.2 8.6 49.5 28 99.6 53.2 137.8 43.7 65.9 115.7 111 209.8 131.5 43.1 9.4 79.7 12.6 133.5 11.8 35.7-.5 53.5-2 81.1-6.7 65.8-11.3 123.2-36.1 167.4-72.5 11.7-9.7 31.5-29.7 40.3-40.8 8.8-11.1 20.1-28.5 26.6-40.8 3.1-5.8 5.6-10.9 5.6-11.2 0-.4-17.9-.7-39.7-.6h-39.8l-7 8.5c-38.3 46.7-99.5 77.4-176.7 88.8-41.7 6.2-104.4 6.2-146.1.1-61.3-9.1-114.4-30.2-152.2-60.6-39.9-32.1-70.3-81.2-84.5-136.4-16.1-62.7-10.3-139.9 15.6-208.5 23.4-61.6 59.1-107.6 108.9-140.2 40.3-26.4 84.9-41.1 143-46.9 15.5-1.6 59.6-1.6 75 0 65.7 6.6 115 27.8 153.2 65.9 36.8 36.6 57.4 80.1 62.4 131.7 1.6 16.8.7 44.7-2.1 61-11 65.1-49.7 124.8-100.4 155.3-11.5 6.9-24.7 11-31.1 9.6-10.2-2.2-13.6-10.9-11-28.7 1.7-12.4 1.2-9.7 20.5-103.7 3.9-19 7.5-36.5 8-39s4.1-20 8-39c3.9-19 7.5-36.5 8-39s4.1-20 8-39c3.9-19 7.4-36 7.7-37.8l.6-3.2h-99l-4.3 19.7c-2.3 10.9-4.5 20.4-4.9 21-.4.8-2.7-1.5-6.1-6.3-14.5-20.3-36.3-34.5-62.2-40.7-8.2-1.9-12.1-2.2-31.8-2.1-19.6 0-23.9.3-33 2.2-32.3 7-59.5 21.5-83.8 44.7-40.1 38.2-70 95.2-80.6 153.5-4.3 23.3-5.9 58.9-3.6 79.5 4.4 39 18 70 41.5 94.4 20 20.8 43.8 34 71.6 39.7 10.4 2.1 38.5 3 49 1.5 29.2-4.2 54.6-16.4 77.3-37.2 3.1-2.8 5.8-5 5.9-4.8.1.2 1.1 2.9 2.1 5.9 4.1 12.2 14 24.1 24.5 29.5 9.8 4.9 19 6.7 37.8 7.2 82.1 2.5 151.7-36.4 202.7-113.4 40-60.4 55.7-128.3 47-202.3-5.9-50.2-24.8-99.7-53.2-139.4-48.1-67.1-129.9-109.5-226.7-117.5-18.6-1.5-43.4-2-61.2-1.1zm6.2 227.5c24.8 5.2 44.8 26.2 51.9 54.6 3.7 14.9 4.7 37.7 2.5 57.7-2.6 24.2-11.1 57.2-21.5 83-9.9 24.7-18.8 38.8-34.3 54.3-15.5 15.5-30.3 23.3-49.7 26-21.5 3-39.8-3.4-54.9-19.3-15.1-15.8-22.5-40.3-22.5-74.7 0-44.4 16.1-104.1 36.3-134.6 23.6-35.7 59.2-53.9 92.2-47z"/></svg></a>
					<a href="https://merveilles.town/@flbr" aria-label="Fediverse account" title="Fediverse account"><svg xmlns="http://www.w3.org/2000/svg" baseProfile="full" aria-hidden="true" viewBox="0 0 220 220": ><path d="M140 20a60 60 0 00-60 60h60zM80 200a60 60 0 0060-60H80zM50 80a30 30 0 0130 30 30 30 0 01-30 30 30 30 0 01-30-30 30 30 0 0130-30zm60 0a30 30 0 0130 30 30 30 0 01-30 30 30 30 0 01-30-30 30 30 0 0130-30zm60 0a30 30 0 0130 30 30 30 0 01-30 30 30 30 0 01-30-30 30 30 0 0130-30"/><path d="M80 20a60 60 0 0160 60H80zm60 180a60 60 0 01-60-60h60zM20 20a60 60 0 0160 60H20zm0 180a60 60 0 0060-60H20zM200 20a60 60 0 00-60 60h60zm0 180a60 60 0 01-60-60h60z"/></svg></a>
					<a rel="me" href="https://github.com/flber" aria-label="Github account" title="Github account"><svg class="octicon octicon-mark-github v-align-middle" viewBox="0 0 16 16" version="1.1" aria-hidden="true"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"></path></svg></a>
		        	<span class="dark"><a href='https://webring.xxiivv.com/#random' target='_blank'><img class="webring" src='https://webring.xxiivv.com/icon.black.svg' alt="a white on black symbol of the webring"/></a></span> 
		        	<span class="light"><a href='https://webring.xxiivv.com/#random' target='_blank'><img class="webring" src='https://webring.xxiivv.com/icon.white.svg' alt="a white on black symbol of the webring"/></a></span> 
				</div>
				<div style="float: right; margin-top: -6px;">
					<em>Last updated: {{date}}</em>
				</div>
			</nav>
		</footer>
	</body>
</html>
